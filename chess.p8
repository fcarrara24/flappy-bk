pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
block_unit = 8; 
side = 8
pp = {
    -- color
    -- type
    -- x
    -- y
}
function _init()
    for i=0,15 do
		palt(i, i==2)
	end -- assicura che il colore 1 (e altri) siano opachi
    prepare_setup()
end

function _draw()
    
    cls()
    draw_chessboard()
    draw_pieces()
end
-->8
function draw_chessboard()
    local sprt;
    for i=1, side do
        for j=1, side do 
            sprt = ((i%2)+j)%2 == 0 and 0 or 1
            spr(sprt,i *block_unit,j*block_unit,1,1)
        end
    end
end

function prepare_setup()
    local pawn_y = {2,7}
    local pawn_x = {1,2,3,4,5,6,7,8}

    local rock_y = {1,8}
    local rock_x = {1,8}

    local knight_y = {1,8}
    local knight_x = {2,7}

    local bishop_y = {1,8}
    local bishop_x = {3,6}

    local queen_y = {1,8}
    local queen_x = {4,4}

    local king_y = {1,8}
    local king_x = {5,5}

    local piece_map_type = {'R', 'K', 'B', 'Q', 'N'}
    local piece_map = {rock_x, knight_x, bishop_x, queen_x, king_x}

    add_pieces(pawn_x, pawn_y, 'P', 16)
    add_pieces(bishop_x, bishop_y, 'B', 17)
    add_pieces(rock_x, rock_y, 'R', 18)
    add_pieces(knight_x, knight_y, 'N', 19)
    add_pieces(queen_x, queen_y, 'Q', 20)
    add_pieces(king_x, king_y, 'K',21)

end

function add_pieces(x_list, y_list, type, template)
    for i=1, #y_list do
        for j=1, #x_list do
            local color = assign_color(y_list[i])
            local offset = color =='W' and 0 or 16
            add(pp, {
                x = x_list[j],
                y = y_list[i],
                color = color,
                type = type, 
                template = template + offset
            })
        end
    end
end


function draw_pieces()
    foreach(pp, function (piece)
        spr(piece.template, piece.x *block_unit, piece.y*block_unit, 1,1)
    end)
end

function assign_color(y)
    local color = y>=4 and 'W' or 'B'
    return color
end
__gfx__
66666666333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222212aa2a22227a22200000000000000000000000000000000000000000000000000000000000000000000000000000000
2221722222217222221226222221762221777aa221711aa200000000000000000000000000000000000000000000000000000000000000000000000000000000
2211772222117622221776222217222222177a222277772200000000000000000000000000000000000000000000000000000000000000000000000000000000
22177622222162222221722221216222222172222221722200000000000000000000000000000000000000000000000000000000000000000000000000000000
22276222222162222221722222217222222172222221722200000000000000000000000000000000000000000000000000000000000000000000000000000000
2211772222217222221776222221722222177a2222177a2200000000000000000000000000000000000000000000000000000000000000000000000000000000
211776622211772222177722221126222217772222177a2200000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222217227a22172277200000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222212112122221122200000000000000000000000000000000000000000000000000000000000000000000000000000000
22211222222112222212212222211122211111122112211200000000000000000000000000000000000000000000000000000000000000000000000000000000
22111122221111222211112222112222221111222211112200000000000000000000000000000000000000000000000000000000000000000000000000000000
22111122222112222221122221211222222112222221122200000000000000000000000000000000000000000000000000000000000000000000000000000000
22211222222112222221122222211222222112222221122200000000000000000000000000000000000000000000000000000000000000000000000000000000
22111122222112222211112222211222221111222211112200000000000000000000000000000000000000000000000000000000000000000000000000000000
21111112221111222211112222112122221111222211112200000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222211221122112211200000000000000000000000000000000000000000000000000000000000000000000000000000000
