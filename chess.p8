pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
block_unit = 8; 
side = 8
pp = {
    -- color
    -- type
    -- x
    -- y
}
function _init()
    palt(3, true)   -- imposta il colore 0 come trasparente
    prepare_setup()
end

function _draw()
    
    cls()
    draw_chessboard()
    draw_pieces()
end
-->8
function draw_chessboard()
    local sprt;
    for i=1, side do
        for j=1, side do 
            sprt = ((i%2)+j)%2 == 0 and 0 or 1
            spr(sprt,i *block_unit,j*block_unit,1,1)
        end
    end
end

function prepare_setup()
    local pawn_y = {2,7}
    local pawn_x = {1,2,3,4,5,6,7,8}

    local rock_y = {1,8}
    local rock_x = {1,8}

    local knight_y = {1,8}
    local knight_x = {2,7}

    local bishop_y = {1,8}
    local bishop_x = {3,6}

    local queen_y = {1,8}
    local queen_x = {4,4}

    local king_y = {1,8}
    local king_x = {5,5}

    local piece_map_type = {'R', 'K', 'B', 'Q', 'N'}
    local piece_map = {rock_x, knight_x, bishop_x, queen_x, king_x}

    add_pieces(pawn_x, pawn_y, 'P', 16)
    add_pieces(bishop_x, bishop_y, 'B', 17)
    add_pieces(rock_x, rock_y, 'R', 18)
    add_pieces(knight_x, knight_y, 'N', 19)
    add_pieces(queen_x, queen_y, 'Q', 20)
    add_pieces(king_x, king_y, 'K',21)

end

function add_pieces(x_list, y_list, type, template)
    for i=1, #y_list do
        for j=1, #x_list do
            local color = assign_color(y_list[i])
            local offset = color =='W' and 0 or 16
            add(pp, {
                x = x_list[j],
                y = y_list[i],
                color = color,
                type = type, 
                template = template + offset
            })
        end
    end
end


function draw_pieces()
    foreach(pp, function (piece)
        spr(piece.template, piece.x *block_unit, piece.y*block_unit, 1,1)
    end)
end

function assign_color(y)
    local color = y>=4 and 'W' or 'B'
    return color
end
__gfx__
66666666333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
677777763bbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222272772720000022222277222000002220000000000000000000000000000000000000000000000000000000000000000
22277222222772222272272222277722277777721111177227722772111117720000000000000000000000000000000000000000000000000000000000000000
22777722227777222277772222772222227777224444400222777722444447220000000000000000000000000000000000000000000000000000000000000000
22777722222772222227722227277222222772228888800222277222888882220000000000000000000000000000000000000000000000000000000000000000
2227722222277222222772222227722222277222ccccc00222277222ccccc2220000000000000000000000000000000000000000000000000000000000000000
22777722222772222277772222277222227777221111100222777722227777220000000000000000000000000000000000000000000000000000000000000000
27777772227777222277772222772722227777222277772222777722227777220000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222277227722772277227722772277227720000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222212112122221122200000000000000000000000000000000000000000000000000000000000000000000000000000000
22211222222112222212212222211122211111122112211200000000000000000000000000000000000000000000000000000000000000000000000000000000
22111122221111222211112222112222221111222211112200000000000000000000000000000000000000000000000000000000000000000000000000000000
22111122222112222221122221211222222112222221122200000000000000000000000000000000000000000000000000000000000000000000000000000000
22211222222112222221122222211222222112222221122200000000000000000000000000000000000000000000000000000000000000000000000000000000
22111122222112222211112222211222221111222211112200000000000000000000000000000000000000000000000000000000000000000000000000000000
21111112221111222211112222112122221111222211112200000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222222222222211221122112211200000000000000000000000000000000000000000000000000000000000000000000000000000000
